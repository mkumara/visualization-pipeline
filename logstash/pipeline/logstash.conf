input {
	beats {
		port => 5000
	}
}




filter {
if [fields][type] == "apache_error_log" {
    grok {
        patterns_dir => [ "/etc/logstash/patterns.d" ]
        match => [ "message", "%{HTTPD24_ERRORLOG}"]
    }
    geoip {
        source => "clientip"
    }

   }

   if [fields][type] == "apache_access_log" {
    grok {
        patterns_dir => [ "/etc/logstash/patterns.d" ]
        match => [ "message", "%{HTTPD_ACCESS_LOG}"]
    }

   }

   if [fields][type] == "ssl_error_log" {
    grok {
        patterns_dir => [ "/etc/logstash/patterns.d" ]
        match => [ "message", "%{HTTPD24_ERRORLOG}"]
    }
    geoip {
        source => "clientip"
    }

   }

   if [fields][type] == "ssl_access_log" {
    grok {
        patterns_dir => [ "/etc/logstash/patterns.d" ]
        match => [ "message", "%{SSL_ACCESS_LOG}"]
    }

   }

    if [fields][type] == "ssl_request_log" {
    grok {
        patterns_dir => [ "/etc/logstash/patterns.d" ]
        match => [ "message", "%{SSL_REQUEST_LOG}"]
    }

   }

   if [fields][type] == "salesforce_error_log" {
    grok {
        patterns_dir => [ "/etc/logstash/patterns.d" ]
        match => [ "message", "%{SALESFORCE}"]
    }

   }
}


output {
if [fields][type] == "apache_error_log"{
	elasticsearch {
			hosts => "elasticsearch:9200"
			index => "apache-error-%{+YYYY.MM.dd}"
		}
	
}

if [fields][type] == "apache_access_log"{
	elasticsearch {
			hosts => "elasticsearch:9200"
			index => "apache-access-%{+YYYY.MM.dd}"
		}
	
}

if [fields][type] == "ssl_error_log"{
	elasticsearch {
			hosts => "elasticsearch:9200"
			index => "apache-error-%{+YYYY.MM.dd}"
		}
	
}

if [fields][type] == "ssl_access_log"{
	elasticsearch {
			hosts => "elasticsearch:9200"
			index => "apache-access-%{+YYYY.MM.dd}"
		}
	
}

if [fields][type] == "ssl_request_log"{
	elasticsearch {
			hosts => "elasticsearch:9200"
			index => "ssl-request-%{+YYYY.MM.dd}"
		}
	
}

if [fields][type] == "salesforce_error_log"{
	elasticsearch {
			hosts => "elasticsearch:9200"
			index => "salesforce-error-%{+YYYY.MM.dd}"
		}
	
}
	
}
